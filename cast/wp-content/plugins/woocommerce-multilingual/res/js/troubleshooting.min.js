jQuery(function(a){WCML_Troubleshooting={init:function(){a(document).ready(function(){jQuery("#wcml_trbl").on("click",function(){var a=jQuery(this);a.attr("disabled","disabled"),jQuery(".spinner").css("display","inline-block").css("visibility","visible"),jQuery("#wcml_sync_update_product_count").is(":checked")?WCML_Troubleshooting.update_product_count():WCML_Troubleshooting.run_next_troubleshooting_action()}),jQuery("#attr_to_duplicate").on("change",function(){jQuery(".attr_status").html(jQuery(this).find("option:selected").attr("rel")),jQuery("#count_terms").val(jQuery(this).find("option:selected").attr("rel"))}),jQuery("#wcml_product_type_trbl").on("click",function(){var a=jQuery(this);a.attr("disabled","disabled"),jQuery(".product_type_spinner").css("display","inline-block").css("visibility","visible"),WCML_Troubleshooting.fix_product_type_terms()})})},update_product_count:function(){jQuery.ajax({type:"post",url:ajaxurl,data:{action:"trbl_update_count",wcml_nonce:jQuery("#trbl_update_count_nonce").val()},dataType:"json",success:function(a){jQuery(".var_status").each(function(){jQuery(this).html(a.data.count)}),jQuery("#count_prod_variat").val(a.data.count),WCML_Troubleshooting.run_next_troubleshooting_action()}})},sync_variations:function(){jQuery.ajax({type:"post",url:ajaxurl,data:{action:"trbl_sync_variations",wcml_nonce:jQuery("#trbl_sync_variations_nonce").val()},dataType:"json",success:function(a){if(0==jQuery("#count_prod_variat").val())jQuery(".var_status").each(function(){jQuery(this).html(0)}),WCML_Troubleshooting.run_next_troubleshooting_action();else{var b=jQuery("#count_prod_variat").val()-3;0>b&&(b=0),jQuery(".var_status").each(function(){jQuery(this).html(b)}),jQuery("#count_prod_variat").val(b),WCML_Troubleshooting.sync_variations()}}})},sync_product_gallery:function(){jQuery.ajax({type:"post",url:ajaxurl,data:{action:"trbl_gallery_images",wcml_nonce:jQuery("#trbl_gallery_images_nonce").val(),page:jQuery("#sync_galerry_page").val()},dataType:"json",success:function(a){if(0==jQuery("#count_galleries").val())WCML_Troubleshooting.run_next_troubleshooting_action(),jQuery(".gallery_status").html(0);else{var b=jQuery("#count_galleries").val()-5;0>b?b=0:jQuery("#sync_galerry_page").val(parseInt(jQuery("#sync_galerry_page").val())+1),jQuery(".gallery_status").html(b),jQuery("#count_galleries").val(b),WCML_Troubleshooting.sync_product_gallery()}}})},sync_product_categories:function(){jQuery.ajax({type:"post",url:ajaxurl,data:{action:"trbl_sync_categories",wcml_nonce:jQuery("#trbl_sync_categories_nonce").val(),page:jQuery("#sync_category_page").val()},success:function(a){if(0==jQuery("#count_categories").val())WCML_Troubleshooting.run_next_troubleshooting_action(),jQuery(".cat_status").html(0);else{var b=jQuery("#count_categories").val()-5;0>b?b=0:jQuery("#sync_category_page").val(parseInt(jQuery("#sync_category_page").val())+1),jQuery(".cat_status").html(b),jQuery("#count_categories").val(b),WCML_Troubleshooting.sync_product_categories()}}})},duplicate_terms:function(){jQuery.ajax({type:"post",url:ajaxurl,data:{action:"trbl_duplicate_terms",wcml_nonce:jQuery("#trbl_duplicate_terms_nonce").val(),attr:jQuery("#attr_to_duplicate option:selected").val()},dataType:"json",success:function(a){if(0==jQuery("#count_terms").val())WCML_Troubleshooting.run_next_troubleshooting_action(),jQuery(".attr_status").html(0);else{var b=jQuery("#count_terms").val()-5;0>b&&(b=0),jQuery(".attr_status").html(b),jQuery("#count_terms").val(b),WCML_Troubleshooting.duplicate_terms()}}})},sync_stock:function(){jQuery.ajax({type:"post",url:ajaxurl,data:{action:"trbl_sync_stock",wcml_nonce:jQuery("#trbl_sync_stock_nonce").val()},dataType:"json",success:function(a){jQuery("#count_stock").val(0),WCML_Troubleshooting.run_next_troubleshooting_action(),jQuery(".stock_status").html(0)}})},fix_product_type_terms:function(){jQuery.ajax({type:"post",url:ajaxurl,data:{action:"trbl_fix_product_type_terms",wcml_nonce:jQuery("#trbl_product_type_terms_nonce").val()},dataType:"json",success:function(a){jQuery("#wcml_product_type_trbl").removeAttr("disabled"),jQuery(".product_type_spinner").hide(),jQuery(".product_type_fix_done").show(),setTimeout(function(){jQuery(".product_type_fix_done").fadeOut(300)},2e3)}})},run_next_troubleshooting_action:function(){jQuery("#wcml_sync_product_variations").is(":checked")&&0!==parseInt(jQuery("#count_prod_variat").val())?WCML_Troubleshooting.sync_variations():jQuery("#wcml_sync_gallery_images").is(":checked")&&0!==parseInt(jQuery("#count_galleries").val())?WCML_Troubleshooting.sync_product_gallery():jQuery("#wcml_sync_categories").is(":checked")&&0!==parseInt(jQuery("#count_categories").val())?WCML_Troubleshooting.sync_product_categories():jQuery("#wcml_duplicate_terms").is(":checked")&&0!==parseInt(jQuery("#count_terms").val())?WCML_Troubleshooting.duplicate_terms():jQuery("#wcml_sync_stock").is(":checked")&&0!==parseInt(jQuery("#count_stock").val())?WCML_Troubleshooting.sync_stock():(jQuery("#wcml_trbl").removeAttr("disabled"),jQuery(".spinner").hide(),jQuery("#wcml_trbl").next().fadeOut())}},WCML_Troubleshooting.init()});